{"format_version":"0.1","terraform_version":"1.0.0","variables":{"account_id":{"value":"3103539"},"api_key":{"value":"NRAK-RPOKDHYE48SMXR761FVPJYTZYXG"},"region":{"value":"US"}},"planned_values":{"root_module":{"child_modules":[{"resources":[{"address":"module.relational_databases_alerts.newrelic_alert_channel.ops_engine[0]","mode":"managed","type":"newrelic_alert_channel","name":"ops_engine","index":0,"provider_name":"registry.terraform.io/newrelic/newrelic","schema_version":0,"values":{"config":[{"api_key":"31a5ed3e-6631-484c-b0af-8e537998c4bf","auth_password":null,"auth_type":null,"auth_username":null,"base_url":null,"channel":null,"headers":null,"headers_string":null,"include_json_attachment":null,"key":null,"payload":null,"payload_string":null,"payload_type":null,"recipients":null,"region":"US","route_key":null,"service_key":null,"tags":null,"teams":null,"url":null,"user_id":null}],"name":"avaliacoes-ops-engine","type":"opsgenie"}},{"address":"module.relational_databases_alerts.newrelic_alert_policy.ops_engine_channels[0]","mode":"managed","type":"newrelic_alert_policy","name":"ops_engine_channels","index":0,"provider_name":"registry.terraform.io/newrelic/newrelic","schema_version":0,"values":{"incident_preference":"PER_CONDITION","name":"avaliacoes"}},{"address":"module.relational_databases_alerts.newrelic_nrql_alert_condition.cpu_peak_percentage[0]","mode":"managed","type":"newrelic_nrql_alert_condition","name":"cpu_peak_percentage","index":0,"provider_name":"registry.terraform.io/newrelic/newrelic","schema_version":0,"values":{"aggregation_delay":null,"aggregation_method":null,"aggregation_timer":null,"aggregation_window":60,"baseline_direction":null,"close_violations_on_expiration":true,"critical":[{"duration":null,"operator":"equals","threshold":90,"threshold_duration":900,"threshold_occurrences":"at_least_once","time_function":null}],"description":"CPU Database Percentage Peak 'prd-dam-1'","enabled":true,"expiration_duration":300,"fill_option":null,"fill_value":null,"name":"CPU Database Percentage Peak 'prd-dam-1'","nrql":[{"evaluation_offset":null,"query":"SELECT max(`aws.rds.CPUUtilization`) FROM Metric FACET `aws.rds.DBInstanceIdentifier` where  aws.rds.DBInstanceIdentifier =  'prd-dam-1'","since_value":null}],"open_violation_on_expiration":null,"runbook_url":null,"slide_by":null,"term":[],"type":"static","value_function":null,"violation_time_limit_seconds":86400,"warning":[]}},{"address":"module.relational_databases_alerts.newrelic_nrql_alert_condition.cpu_percentage_equal[0]","mode":"managed","type":"newrelic_nrql_alert_condition","name":"cpu_percentage_equal","index":0,"provider_name":"registry.terraform.io/newrelic/newrelic","schema_version":0,"values":{"aggregation_delay":null,"aggregation_method":null,"aggregation_timer":null,"aggregation_window":60,"baseline_direction":null,"close_violations_on_expiration":true,"critical":[{"duration":null,"operator":"equals","threshold":70,"threshold_duration":900,"threshold_occurrences":"all","time_function":null}],"description":"CPU Database Percentage 'prd-dam-1'","enabled":true,"expiration_duration":300,"fill_option":null,"fill_value":null,"name":"CPU Database Percentage 'prd-dam-1'","nrql":[{"evaluation_offset":null,"query":"SELECT average(`aws.rds.CPUUtilization`) FROM Metric FACET `aws.rds.DBInstanceIdentifier` WHERE aws.rds.DBInstanceIdentifier =  'prd-dam-1'","since_value":null}],"open_violation_on_expiration":null,"runbook_url":null,"slide_by":null,"term":[],"type":"static","value_function":null,"violation_time_limit_seconds":86400,"warning":[]}},{"address":"module.relational_databases_alerts.newrelic_nrql_alert_condition.database_connection_equal[0]","mode":"managed","type":"newrelic_nrql_alert_condition","name":"database_connection_equal","index":0,"provider_name":"registry.terraform.io/newrelic/newrelic","schema_version":0,"values":{"aggregation_delay":null,"aggregation_method":null,"aggregation_timer":null,"aggregation_window":60,"baseline_direction":null,"close_violations_on_expiration":true,"critical":[{"duration":null,"operator":"equals","threshold":30,"threshold_duration":900,"threshold_occurrences":"at_least_once","time_function":null}],"description":"Connection Database 'prd-dam-1'","enabled":true,"expiration_duration":300,"fill_option":null,"fill_value":null,"name":"Connection Database 'prd-dam-1'","nrql":[{"evaluation_offset":null,"query":"SELECT max(`aws.rds.DatabaseConnections`) FROM Metric FACET `aws.rds.DBInstanceIdentifier` WHERE aws.rds.DBInstanceIdentifier =  'prd-dam-1'","since_value":null}],"open_violation_on_expiration":null,"runbook_url":null,"slide_by":null,"term":[],"type":"static","value_function":null,"violation_time_limit_seconds":86400,"warning":[]}},{"address":"module.relational_databases_alerts.newrelic_nrql_alert_condition.database_lock_equal[0]","mode":"managed","type":"newrelic_nrql_alert_condition","name":"database_lock_equal","index":0,"provider_name":"registry.terraform.io/newrelic/newrelic","schema_version":0,"values":{"aggregation_delay":null,"aggregation_method":null,"aggregation_timer":null,"aggregation_window":60,"baseline_direction":null,"close_violations_on_expiration":true,"critical":[{"duration":null,"operator":"equals","threshold":15,"threshold_duration":900,"threshold_occurrences":"at_least_once","time_function":null}],"description":"DeadLock Database 'prd-dam-1'","enabled":true,"expiration_duration":300,"fill_option":null,"fill_value":null,"name":"DeadLock Database 'prd-dam-1'","nrql":[{"evaluation_offset":null,"query":"SELECT max(`aws.rds.Deadlocks`) FROM Metric FACET `aws.rds.DBInstanceIdentifier` where aws.rds.DBInstanceIdentifier =  'prd-dam-1'","since_value":null}],"open_violation_on_expiration":null,"runbook_url":null,"slide_by":null,"term":[],"type":"static","value_function":null,"violation_time_limit_seconds":86400,"warning":[]}}],"address":"module.relational_databases_alerts"}]}},"resource_changes":[{"address":"module.relational_databases_alerts.newrelic_alert_channel.ops_engine[0]","module_address":"module.relational_databases_alerts","mode":"managed","type":"newrelic_alert_channel","name":"ops_engine","index":0,"provider_name":"registry.terraform.io/newrelic/newrelic","change":{"actions":["create"],"before":null,"after":{"config":[{"api_key":"31a5ed3e-6631-484c-b0af-8e537998c4bf","auth_password":null,"auth_type":null,"auth_username":null,"base_url":null,"channel":null,"headers":null,"headers_string":null,"include_json_attachment":null,"key":null,"payload":null,"payload_string":null,"payload_type":null,"recipients":null,"region":"US","route_key":null,"service_key":null,"tags":null,"teams":null,"url":null,"user_id":null}],"name":"avaliacoes-ops-engine","type":"opsgenie"},"after_unknown":{"account_id":true,"config":[{}],"id":true},"before_sensitive":false,"after_sensitive":{"config":[{"api_key":true,"auth_password":true,"auth_type":true,"base_url":true,"headers":true,"headers_string":true,"key":true,"payload":true,"payload_string":true,"route_key":true,"service_key":true,"url":true}]}}},{"address":"module.relational_databases_alerts.newrelic_alert_policy.ops_engine_channels[0]","module_address":"module.relational_databases_alerts","mode":"managed","type":"newrelic_alert_policy","name":"ops_engine_channels","index":0,"provider_name":"registry.terraform.io/newrelic/newrelic","change":{"actions":["create"],"before":null,"after":{"incident_preference":"PER_CONDITION","name":"avaliacoes"},"after_unknown":{"account_id":true,"channel_ids":true,"id":true},"before_sensitive":false,"after_sensitive":{"channel_ids":[]}}},{"address":"module.relational_databases_alerts.newrelic_nrql_alert_condition.cpu_peak_percentage[0]","module_address":"module.relational_databases_alerts","mode":"managed","type":"newrelic_nrql_alert_condition","name":"cpu_peak_percentage","index":0,"provider_name":"registry.terraform.io/newrelic/newrelic","change":{"actions":["create"],"before":null,"after":{"aggregation_delay":null,"aggregation_method":null,"aggregation_timer":null,"aggregation_window":60,"baseline_direction":null,"close_violations_on_expiration":true,"critical":[{"duration":null,"operator":"equals","threshold":90,"threshold_duration":900,"threshold_occurrences":"at_least_once","time_function":null}],"description":"CPU Database Percentage Peak 'prd-dam-1'","enabled":true,"expiration_duration":300,"fill_option":null,"fill_value":null,"name":"CPU Database Percentage Peak 'prd-dam-1'","nrql":[{"evaluation_offset":null,"query":"SELECT max(`aws.rds.CPUUtilization`) FROM Metric FACET `aws.rds.DBInstanceIdentifier` where  aws.rds.DBInstanceIdentifier =  'prd-dam-1'","since_value":null}],"open_violation_on_expiration":null,"runbook_url":null,"slide_by":null,"term":[],"type":"static","value_function":null,"violation_time_limit_seconds":86400,"warning":[]},"after_unknown":{"account_id":true,"critical":[{}],"entity_guid":true,"id":true,"nrql":[{}],"policy_id":true,"term":[],"violation_time_limit":true,"warning":[]},"before_sensitive":false,"after_sensitive":{"critical":[{}],"nrql":[{}],"term":[],"warning":[]}}},{"address":"module.relational_databases_alerts.newrelic_nrql_alert_condition.cpu_percentage_equal[0]","module_address":"module.relational_databases_alerts","mode":"managed","type":"newrelic_nrql_alert_condition","name":"cpu_percentage_equal","index":0,"provider_name":"registry.terraform.io/newrelic/newrelic","change":{"actions":["create"],"before":null,"after":{"aggregation_delay":null,"aggregation_method":null,"aggregation_timer":null,"aggregation_window":60,"baseline_direction":null,"close_violations_on_expiration":true,"critical":[{"duration":null,"operator":"equals","threshold":70,"threshold_duration":900,"threshold_occurrences":"all","time_function":null}],"description":"CPU Database Percentage 'prd-dam-1'","enabled":true,"expiration_duration":300,"fill_option":null,"fill_value":null,"name":"CPU Database Percentage 'prd-dam-1'","nrql":[{"evaluation_offset":null,"query":"SELECT average(`aws.rds.CPUUtilization`) FROM Metric FACET `aws.rds.DBInstanceIdentifier` WHERE aws.rds.DBInstanceIdentifier =  'prd-dam-1'","since_value":null}],"open_violation_on_expiration":null,"runbook_url":null,"slide_by":null,"term":[],"type":"static","value_function":null,"violation_time_limit_seconds":86400,"warning":[]},"after_unknown":{"account_id":true,"critical":[{}],"entity_guid":true,"id":true,"nrql":[{}],"policy_id":true,"term":[],"violation_time_limit":true,"warning":[]},"before_sensitive":false,"after_sensitive":{"critical":[{}],"nrql":[{}],"term":[],"warning":[]}}},{"address":"module.relational_databases_alerts.newrelic_nrql_alert_condition.database_connection_equal[0]","module_address":"module.relational_databases_alerts","mode":"managed","type":"newrelic_nrql_alert_condition","name":"database_connection_equal","index":0,"provider_name":"registry.terraform.io/newrelic/newrelic","change":{"actions":["create"],"before":null,"after":{"aggregation_delay":null,"aggregation_method":null,"aggregation_timer":null,"aggregation_window":60,"baseline_direction":null,"close_violations_on_expiration":true,"critical":[{"duration":null,"operator":"equals","threshold":30,"threshold_duration":900,"threshold_occurrences":"at_least_once","time_function":null}],"description":"Connection Database 'prd-dam-1'","enabled":true,"expiration_duration":300,"fill_option":null,"fill_value":null,"name":"Connection Database 'prd-dam-1'","nrql":[{"evaluation_offset":null,"query":"SELECT max(`aws.rds.DatabaseConnections`) FROM Metric FACET `aws.rds.DBInstanceIdentifier` WHERE aws.rds.DBInstanceIdentifier =  'prd-dam-1'","since_value":null}],"open_violation_on_expiration":null,"runbook_url":null,"slide_by":null,"term":[],"type":"static","value_function":null,"violation_time_limit_seconds":86400,"warning":[]},"after_unknown":{"account_id":true,"critical":[{}],"entity_guid":true,"id":true,"nrql":[{}],"policy_id":true,"term":[],"violation_time_limit":true,"warning":[]},"before_sensitive":false,"after_sensitive":{"critical":[{}],"nrql":[{}],"term":[],"warning":[]}}},{"address":"module.relational_databases_alerts.newrelic_nrql_alert_condition.database_lock_equal[0]","module_address":"module.relational_databases_alerts","mode":"managed","type":"newrelic_nrql_alert_condition","name":"database_lock_equal","index":0,"provider_name":"registry.terraform.io/newrelic/newrelic","change":{"actions":["create"],"before":null,"after":{"aggregation_delay":null,"aggregation_method":null,"aggregation_timer":null,"aggregation_window":60,"baseline_direction":null,"close_violations_on_expiration":true,"critical":[{"duration":null,"operator":"equals","threshold":15,"threshold_duration":900,"threshold_occurrences":"at_least_once","time_function":null}],"description":"DeadLock Database 'prd-dam-1'","enabled":true,"expiration_duration":300,"fill_option":null,"fill_value":null,"name":"DeadLock Database 'prd-dam-1'","nrql":[{"evaluation_offset":null,"query":"SELECT max(`aws.rds.Deadlocks`) FROM Metric FACET `aws.rds.DBInstanceIdentifier` where aws.rds.DBInstanceIdentifier =  'prd-dam-1'","since_value":null}],"open_violation_on_expiration":null,"runbook_url":null,"slide_by":null,"term":[],"type":"static","value_function":null,"violation_time_limit_seconds":86400,"warning":[]},"after_unknown":{"account_id":true,"critical":[{}],"entity_guid":true,"id":true,"nrql":[{}],"policy_id":true,"term":[],"violation_time_limit":true,"warning":[]},"before_sensitive":false,"after_sensitive":{"critical":[{}],"nrql":[{}],"term":[],"warning":[]}}}],"configuration":{"provider_config":{"module.relational_databases_alerts:newrelic":{"name":"newrelic","module_address":"module.relational_databases_alerts","expressions":{"account_id":{"references":["var.account_id"]},"api_key":{"references":["var.api_key"]},"region":{"references":["var.region"]}}},"newrelic":{"name":"newrelic","expressions":{"account_id":{"references":["var.account_id"]},"api_key":{"references":["var.api_key"]},"region":{"references":["var.region"]}}}},"root_module":{"module_calls":{"relational_databases_alerts":{"source":"./modules/relational-databases","expressions":{"alert_policy_name":{"constant_value":"avaliacoes"},"channel_slack":{"constant_value":""},"operator":{"constant_value":""},"ops_engine_integration":{"constant_value":true},"relactional_database":{"constant_value":true},"relactional_database_name":{"constant_value":"'prd-dam-1'"},"threshold_cpu":{"constant_value":70},"threshold_cpu_connection":{"constant_value":30},"threshold_cpu_connection_duration":{"constant_value":900},"threshold_cpu_deadlock":{"constant_value":15},"threshold_cpu_deadlock_duration":{"constant_value":900},"threshold_cpu_duration":{"constant_value":900},"threshold_cpu_peak":{"constant_value":90},"threshold_cpu_peak_duration":{"constant_value":900},"trybe_name":{"constant_value":"avaliacoes"},"url_slack":{"constant_value":""}},"module":{"resources":[{"address":"newrelic_alert_channel.ops_engine","mode":"managed","type":"newrelic_alert_channel","name":"ops_engine","provider_config_key":"relational_databases_alerts:newrelic","expressions":{"config":[{"api_key":{"references":["var.ops_engine_api_key"]},"region":{"references":["var.ops_engine_region"]}}],"name":{"references":["var.trybe_name"]},"type":{"constant_value":"opsgenie"}},"schema_version":0,"count_expression":{"references":["var.ops_engine_integration"]}},{"address":"newrelic_alert_channel.slack_channel","mode":"managed","type":"newrelic_alert_channel","name":"slack_channel","provider_config_key":"relational_databases_alerts:newrelic","expressions":{"config":[{"channel":{"references":["var.channel_slack"]},"url":{"references":["var.url_slack"]}}],"name":{"references":["var.trybe_name"]},"type":{"constant_value":"slack"}},"schema_version":0,"count_expression":{"references":["var.ops_engine_integration"]}},{"address":"newrelic_alert_policy.ops_engine_channels","mode":"managed","type":"newrelic_alert_policy","name":"ops_engine_channels","provider_config_key":"relational_databases_alerts:newrelic","expressions":{"channel_ids":{"references":["newrelic_alert_channel.ops_engine[0]"]},"incident_preference":{"constant_value":"PER_CONDITION"},"name":{"references":["var.alert_policy_name"]}},"schema_version":0,"count_expression":{"references":["var.ops_engine_integration"]}},{"address":"newrelic_alert_policy.slack_channels","mode":"managed","type":"newrelic_alert_policy","name":"slack_channels","provider_config_key":"relational_databases_alerts:newrelic","expressions":{"channel_ids":{"references":["newrelic_alert_channel.slack_channel[0]"]},"incident_preference":{"constant_value":"PER_CONDITION"},"name":{"references":["var.alert_policy_name"]}},"schema_version":0,"count_expression":{"references":["var.ops_engine_integration"]}},{"address":"newrelic_nrql_alert_condition.cpu_peak_percentage","mode":"managed","type":"newrelic_nrql_alert_condition","name":"cpu_peak_percentage","provider_config_key":"relational_databases_alerts:newrelic","expressions":{"aggregation_window":{"references":["var.aggregation_window"]},"close_violations_on_expiration":{"references":["var.close_violations_on_expiration"]},"critical":[{"threshold":{"references":["var.threshold_cpu_peak"]},"threshold_duration":{"references":["var.threshold_cpu_peak_duration"]},"threshold_occurrences":{"constant_value":"AT_LEAST_ONCE"}}],"description":{"references":["var.relactional_database_name"]},"enabled":{"references":["var.enabled"]},"expiration_duration":{"references":["var.expiration_duration"]},"name":{"references":["var.relactional_database_name"]},"nrql":[{"query":{"references":["var.query_peak_cpu_percentage","var.relactional_database_name"]}}],"policy_id":{"references":["var.ops_engine_integration","newrelic_alert_policy.ops_engine_channels[0]","newrelic_alert_policy.slack_channels[0]"]},"type":{"constant_value":"static"},"violation_time_limit_seconds":{"references":["var.violation_time_limit_seconds"]}},"schema_version":0,"count_expression":{"references":["var.operator","var.relactional_database"]}},{"address":"newrelic_nrql_alert_condition.cpu_percentage","mode":"managed","type":"newrelic_nrql_alert_condition","name":"cpu_percentage","provider_config_key":"relational_databases_alerts:newrelic","expressions":{"aggregation_window":{"references":["var.aggregation_window"]},"close_violations_on_expiration":{"references":["var.close_violations_on_expiration"]},"critical":[{"operator":{"references":["var.operator"]},"threshold":{"references":["var.threshold_cpu"]},"threshold_duration":{"references":["var.threshold_cpu_duration"]},"threshold_occurrences":{"constant_value":"ALL"}}],"description":{"references":["var.relactional_database_name"]},"enabled":{"references":["var.enabled"]},"expiration_duration":{"references":["var.expiration_duration"]},"name":{"references":["var.relactional_database_name"]},"nrql":[{"query":{"references":["var.query_cpu_percentage","var.relactional_database_name"]}}],"policy_id":{"references":["var.ops_engine_integration","newrelic_alert_policy.ops_engine_channels[0]","newrelic_alert_policy.slack_channels[0]"]},"type":{"constant_value":"static"},"violation_time_limit_seconds":{"references":["var.violation_time_limit_seconds"]}},"schema_version":0,"count_expression":{"references":["var.operator","var.relactional_database"]}},{"address":"newrelic_nrql_alert_condition.cpu_percentage_equal","mode":"managed","type":"newrelic_nrql_alert_condition","name":"cpu_percentage_equal","provider_config_key":"relational_databases_alerts:newrelic","expressions":{"aggregation_window":{"references":["var.aggregation_window"]},"close_violations_on_expiration":{"references":["var.close_violations_on_expiration"]},"critical":[{"threshold":{"references":["var.threshold_cpu"]},"threshold_duration":{"references":["var.threshold_cpu_duration"]},"threshold_occurrences":{"constant_value":"ALL"}}],"description":{"references":["var.relactional_database_name"]},"enabled":{"references":["var.enabled"]},"expiration_duration":{"references":["var.expiration_duration"]},"name":{"references":["var.relactional_database_name"]},"nrql":[{"query":{"references":["var.query_cpu_percentage","var.relactional_database_name"]}}],"policy_id":{"references":["var.ops_engine_integration","newrelic_alert_policy.ops_engine_channels[0]","newrelic_alert_policy.slack_channels[0]"]},"type":{"constant_value":"static"},"violation_time_limit_seconds":{"references":["var.violation_time_limit_seconds"]}},"schema_version":0,"count_expression":{"references":["var.operator","var.relactional_database"]}},{"address":"newrelic_nrql_alert_condition.database_connection","mode":"managed","type":"newrelic_nrql_alert_condition","name":"database_connection","provider_config_key":"relational_databases_alerts:newrelic","expressions":{"aggregation_window":{"references":["var.aggregation_window"]},"close_violations_on_expiration":{"references":["var.close_violations_on_expiration"]},"critical":[{"operator":{"references":["var.operator"]},"threshold":{"references":["var.threshold_cpu_connection"]},"threshold_duration":{"references":["var.threshold_cpu_connection_duration"]},"threshold_occurrences":{"constant_value":"AT_LEAST_ONCE"}}],"description":{"references":["var.relactional_database_name"]},"enabled":{"references":["var.enabled"]},"expiration_duration":{"references":["var.expiration_duration"]},"name":{"references":["var.relactional_database_name"]},"nrql":[{"query":{"references":["var.query_how_many_connection","var.relactional_database_name"]}}],"policy_id":{"references":["var.ops_engine_integration","newrelic_alert_policy.ops_engine_channels[0]","newrelic_alert_policy.slack_channels[0]"]},"type":{"constant_value":"static"},"violation_time_limit_seconds":{"references":["var.violation_time_limit_seconds"]}},"schema_version":0,"count_expression":{"references":["var.operator","var.relactional_database"]}},{"address":"newrelic_nrql_alert_condition.database_connection_equal","mode":"managed","type":"newrelic_nrql_alert_condition","name":"database_connection_equal","provider_config_key":"relational_databases_alerts:newrelic","expressions":{"aggregation_window":{"references":["var.aggregation_window"]},"close_violations_on_expiration":{"references":["var.close_violations_on_expiration"]},"critical":[{"threshold":{"references":["var.threshold_cpu_connection"]},"threshold_duration":{"references":["var.threshold_cpu_connection_duration"]},"threshold_occurrences":{"constant_value":"AT_LEAST_ONCE"}}],"description":{"references":["var.relactional_database_name"]},"enabled":{"references":["var.enabled"]},"expiration_duration":{"references":["var.expiration_duration"]},"name":{"references":["var.relactional_database_name"]},"nrql":[{"query":{"references":["var.query_how_many_connection","var.relactional_database_name"]}}],"policy_id":{"references":["var.ops_engine_integration","newrelic_alert_policy.ops_engine_channels[0]","newrelic_alert_policy.slack_channels[0]"]},"type":{"constant_value":"static"},"violation_time_limit_seconds":{"references":["var.violation_time_limit_seconds"]}},"schema_version":0,"count_expression":{"references":["var.operator","var.relactional_database"]}},{"address":"newrelic_nrql_alert_condition.database_lock","mode":"managed","type":"newrelic_nrql_alert_condition","name":"database_lock","provider_config_key":"relational_databases_alerts:newrelic","expressions":{"aggregation_window":{"references":["var.aggregation_window"]},"close_violations_on_expiration":{"references":["var.close_violations_on_expiration"]},"critical":[{"operator":{"references":["var.operator"]},"threshold":{"references":["var.threshold_cpu_deadlock"]},"threshold_duration":{"references":["var.threshold_cpu_deadlock_duration"]},"threshold_occurrences":{"constant_value":"AT_LEAST_ONCE"}}],"description":{"references":["var.relactional_database_name"]},"enabled":{"references":["var.enabled"]},"expiration_duration":{"references":["var.expiration_duration"]},"name":{"references":["var.relactional_database_name"]},"nrql":[{"query":{"references":["var.query_deadlock","var.relactional_database_name"]}}],"policy_id":{"references":["var.ops_engine_integration","newrelic_alert_policy.ops_engine_channels[0]","newrelic_alert_policy.slack_channels[0]"]},"type":{"constant_value":"static"},"violation_time_limit_seconds":{"references":["var.violation_time_limit_seconds"]}},"schema_version":0,"count_expression":{"references":["var.operator","var.relactional_database"]}},{"address":"newrelic_nrql_alert_condition.database_lock_equal","mode":"managed","type":"newrelic_nrql_alert_condition","name":"database_lock_equal","provider_config_key":"relational_databases_alerts:newrelic","expressions":{"aggregation_window":{"references":["var.aggregation_window"]},"close_violations_on_expiration":{"references":["var.close_violations_on_expiration"]},"critical":[{"threshold":{"references":["var.threshold_cpu_deadlock"]},"threshold_duration":{"references":["var.threshold_cpu_deadlock_duration"]},"threshold_occurrences":{"constant_value":"AT_LEAST_ONCE"}}],"description":{"references":["var.relactional_database_name"]},"enabled":{"references":["var.enabled"]},"expiration_duration":{"references":["var.expiration_duration"]},"name":{"references":["var.relactional_database_name"]},"nrql":[{"query":{"references":["var.query_deadlock","var.relactional_database_name"]}}],"policy_id":{"references":["var.ops_engine_integration","newrelic_alert_policy.ops_engine_channels[0]","newrelic_alert_policy.slack_channels[0]"]},"type":{"constant_value":"static"},"violation_time_limit_seconds":{"references":["var.violation_time_limit_seconds"]}},"schema_version":0,"count_expression":{"references":["var.operator","var.relactional_database"]}}],"variables":{"account_id":{"default":"3103539"},"aggregation_window":{"default":60},"alert_policy_name":{},"api_key":{"default":"NRAK-RPOKDHYE48SMXR761FVPJYTZYXG"},"channel_slack":{"default":""},"close_violations_on_expiration":{"default":true},"enabled":{"default":true},"expiration_duration":{"default":300},"operator":{"default":""},"ops_engine_api_key":{"default":"31a5ed3e-6631-484c-b0af-8e537998c4bf"},"ops_engine_integration":{"default":false},"ops_engine_region":{"default":"US"},"query_cpu_percentage":{"default":"SELECT average(`aws.rds.CPUUtilization`) FROM Metric FACET `aws.rds.DBInstanceIdentifier` WHERE aws.rds.DBInstanceIdentifier = "},"query_deadlock":{"default":"SELECT max(`aws.rds.Deadlocks`) FROM Metric FACET `aws.rds.DBInstanceIdentifier` where aws.rds.DBInstanceIdentifier = "},"query_how_many_connection":{"default":"SELECT max(`aws.rds.DatabaseConnections`) FROM Metric FACET `aws.rds.DBInstanceIdentifier` WHERE aws.rds.DBInstanceIdentifier = "},"query_peak_cpu_percentage":{"default":"SELECT max(`aws.rds.CPUUtilization`) FROM Metric FACET `aws.rds.DBInstanceIdentifier` where  aws.rds.DBInstanceIdentifier = "},"region":{"default":"US"},"relactional_database":{"default":true},"relactional_database_name":{"default":""},"threshold_cpu":{},"threshold_cpu_connection":{},"threshold_cpu_connection_duration":{},"threshold_cpu_deadlock":{},"threshold_cpu_deadlock_duration":{},"threshold_cpu_duration":{},"threshold_cpu_peak":{},"threshold_cpu_peak_duration":{},"trybe_name":{"default":""},"url_slack":{"default":""},"violation_time_limit_seconds":{"default":86400}}}}},"variables":{"account_id":{"default":"3103539"},"api_key":{"default":"NRAK-RPOKDHYE48SMXR761FVPJYTZYXG"},"region":{"default":"US"}}}}}
